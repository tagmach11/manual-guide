@use "./base.scss";

/* =========================
   Quartz 4 Custom SCSS (FINAL)
   ========================= */

/* 팔레트 & 공통 */
$bg: #ffffff;
$primary: #15354a;      // 남색 타이틀
$accent: #f5e3d8;       // 살구 포인트
$shadow: 0 10px 30px rgba(16, 24, 40, .08);

/* ===== 버튼 공통 ===== */
.btn {
  display: inline-block;
  padding: 12px 18px;
  border-radius: 14px;
  font-weight: 700;
  border: 2px solid currentColor;
  text-decoration: none;
  margin-right: 10px;
  transition: transform .12s ease, opacity .12s ease;
  &:hover { transform: translateY(-1px); }
  &.primary { background: $primary; color: #fff; border-color: transparent; }
}

/* ===== 히어로 콜아웃 (배너) ===== */
/* [!hero] 콜아웃 또는 <div class="callout" data-callout="hero">… */
.callout[data-callout="hero"] {
  border: none;
  background: linear-gradient(180deg, #fff 0%, #f6f7fb 100%);
  border-radius: 24px;
  padding: 28px;
  box-shadow: $shadow;
  position: relative;

  .callout-title { display: none; } /* [!hero] 제목줄 숨김 */

  .callout-content {
    display: grid;
    grid-template-columns: 1.1fr .9fr;
    gap: 24px;
    align-items: center;

    h1, h2 {
      color: $primary;
      margin: .1em 0 .3em;
      font-weight: 800;
    }
    p { margin: .3em 0 1em; opacity: .9; }

    .hero-img {
      width: 100%;
      height: auto;
      border-radius: 22px;
      box-shadow: $shadow;
      display: block;
    }
  }

  /* 살구색 배경 오브젝트 */
  &::after {
    content: "";
    position: absolute;
    right: 8%;
    top: 12%;
    width: 220px;
    height: 180px;
    background: $accent;
    border-radius: 42% 58% 40% 60% / 60% 40% 60% 40%;
    filter: blur(2px);
    opacity: .7;
    z-index: 0;
  }
}

/* ===== 페이지 상단에 배너 올리기 (해당 노트에만 적용) ===== */
/* 프런트매터에 cssclass: hero-first 추가 */
.hero-first {
  /* 페이지 타이틀/빵부스러기 숨김(있는 경우만) */
  .page-title, .article-title, header h1,
  .breadcrumb-container, nav.breadcrumbs, .article-metadata {
    display: none !important;
  }

  /* 문서 첫 요소가 hero일 때 상단 여백 제거 */
  .callout[data-callout="hero"]:first-of-type {
    margin-top: 0 !important;
  }

  /* 배너만 강조(여백/그림자는 위의 hero 규칙 사용) */
}

/* ===== 사이드바(Explorer) 은은한 터치만 ===== */
.explorer .item:hover,
.explorer .file:hover,
.explorer .node:hover {
  background: rgba(143,159,169,.08);
  border-radius: 8px;
}
.explorer .item.active,
.explorer .file.active {
  background: rgba(40,75,99,.12);
  font-weight: 700;
  border-radius: 8px;
}

/* ===== 대/중/소 노트별 이미지 통일(옵션) ===== */
/* 노트 프런트매터에 cssclass: menu-big / menu-mid / menu-small */
.menu-big   .markdown-preview-view img { width: 600px; height: auto; border-radius: 12px; object-fit: cover; }
.menu-mid   .markdown-preview-view img { width: 420px; height: auto; border-radius: 10px; object-fit: cover; }
.menu-small .markdown-preview-view img { width: 260px; height: auto; border-radius:  8px; object-fit: cover; }

/* ===== 반응형 ===== */
@media (max-width: 860px) {
  .callout[data-callout="hero"] {
    .callout-content { grid-template-columns: 1fr; gap: 18px; }
    &::after { right: 6%; top: 6%; width: 160px; height: 120px; }
  }
}
/* 공통 버튼 & 콜랩스 기본 */
/* === 토글 버튼 / 내용 기본 === */
.toggle-btn {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  user-select: none;
  margin: 0 0 8px auto; /* 우측 정렬 */
  transition: background .15s ease, border-color .15s ease, color .15s ease, box-shadow .15s ease;
  border: 1px solid var(--interactive-normal, #d1d5db);
  background: var(--interactive-accent, #f3f4f6);
  color: var(--text-normal, #111827); /* <-- 라이트 fallback을 진한 색으로 */
}

.toggle-btn:hover {
  background: var(--background-modifier-hover, #e5e7eb);
}

.toggle-btn:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(59,130,246,.35);
}

.toggle-content {
  display: none;
  margin: .5rem 0 1rem;
  padding: .75rem 1rem;
  border-left: 3px solid #2563eb;
  background: var(--background-secondary, #f9fafb);
  color: var(--text-normal, #111827);   /* <-- 라이트 fallback 진하게 수정 */
  border-radius: 6px;
}
.toggle-content.open { display: block; }

/* === 라이트 모드 명시 === */
html[data-theme="light"] .toggle-btn {
  background: #f3f4f6;
  border-color: #d1d5db;
  color: #111827;
}
html[data-theme="light"] .toggle-content {
  background: #f9fafb;
  color: #111827;
  border-left-color: #2563eb;
}

html[data-theme="dark"] {
  /* 버튼(글자만 버튼처럼 보이는 형태 유지) */
  .toggle-btn {
    background: #16283a;   /* 남색 톤 */
    border-color: #25405b; /* 버튼 테두리 살짝 진하게 */
    color: #ffffff;         /* 흰 글씨 */
  }
  .toggle-btn:hover {
    background: #1c334a;   /* hover 시 조금 더 밝은 남색 */
  }

  /* 콜랩스 내용 박스 */
  .toggle-content {
    background: #0f1f2e;     /* 진한 남색(배경) */
    color: #ffffff;           /* 흰 글씨 */
    border-left: 2px solid #7fb3ff; /* 왼쪽 얇은 라인(파랑) */
    /* box-shadow: 0 2px 8px rgba(0,0,0,.35); */
    /* border-radius: 6px;  // 이미 있으시면 유지 */
  }
}

//파일 추가

/* ===========================================
   Explorer — “진짜 파일 탐색기” 스타일
   =========================================== */

/* 색상 토큰 (라이트 기본) */
:root {
  --exp-text:        #111827;
  --exp-dim:         #6b7280;
  --exp-bg-hover:    rgba(15, 23, 42, .05);
  --exp-bg-active:   rgba(15, 23, 42, .10);
  --exp-line:        rgba(148,163,184,.35);
  --exp-icon:        #334155;
  --exp-folder:      #2563eb; /* 폴더 아이콘 푸른색 */
  --exp-file:        #475569; /* 파일 아이콘 회색 */
}

/* 다크 모드 색상 토큰 */
html[data-theme="dark"], .dark, .theme-dark, [data-theme="dark"] {
  --exp-text:        #e5e7eb;
  --exp-dim:         #9ca3af;
  --exp-bg-hover:    rgba(255,255,255,.06);
  --exp-bg-active:   rgba(255,255,255,.12);
  --exp-line:        rgba(148,163,184,.28);
  --exp-icon:        #cbd5e1;
  --exp-folder:      #93c5fd;
  --exp-file:        #cbd5e1;
}

/* 기본 레이아웃 정리 */
.explorer {
  font-size: 14px;
  line-height: 1.35;
  color: var(--exp-text);
}

/* 각 항목 줄 */
.explorer .item,
.explorer .node,
.explorer .file {
  position: relative;
  display: flex;
  align-items: center;
  gap: .45rem;
  padding: 6px 8px 6px 10px;
  border-radius: 8px;
  color: var(--exp-text);
  cursor: default;
}

/* 호버/선택 강조 */
.explorer .item:hover,
.explorer .node:hover,
.explorer .file:hover {
  background: var(--exp-bg-hover);
}
.explorer .item.active,
.explorer .node.active,
.explorer .file.active {
  background: var(--exp-bg-active);
  font-weight: 700;
}

/* 왼쪽 트리 가이드 라인 */
.explorer .tree,
.explorer .children {
  position: relative;
}
.explorer .children {
  margin-left: 18px; /* 들여쓰기 */
  padding-left: 10px;
  border-left: 1px dashed var(--exp-line);
}

/* 접힘/펼침 토글(화살표) — 폴더/섹션 노드 앞에 */
.explorer .item .caret,
.explorer .node .caret {
  width: 12px;
  height: 12px;
  flex: 0 0 12px;
  margin-right: 2px;
  color: var(--exp-dim);
}

/* Quartz DOM에 caret이 없다면 가짜로 생성 */
.explorer .item.has-children::before,
.explorer .node.has-children::before {
  content: "▸";                    /* 접힘 */
  color: var(--exp-dim);
  width: 12px;
  display: inline-block;
  text-align: center;
  margin-right: 2px;
}
.explorer .item.has-children.is-open::before,
.explorer .node.has-children.is-open::before {
  content: "▾";                    /* 펼침 */
}

/* ===== 아이콘들 (SVG data-URI) ===== */

/* 폴더(닫힘) */
@function svg-url($c) {
  @return url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='#{$c}'>\
<path d='M10 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2z'/>\
</svg>");
}

/* 폴더(열림) */
@function svg-folder-open($c) {
  @return url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='#{$c}'>\
<path d='M3 7a2 2 0 0 1 2-2h5l2 2h7a2 2 0 0 1 2 2v1H6a2 2 0 0 0-1.94 1.5L3 18V7z'/>\
<path d='M21 10H6a1 1 0 0 0-.97.76L4 18a2 2 0 0 0 1.94 2.5H19a2 2 0 0 0 1.94-1.5l1.5-6A2 2 0 0 0 21 10z'/>\
</svg>");
}

/* 파일(문서) */
@function svg-file($c) {
  @return url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='#{$c}'>\
<path d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'/>\
<path d='M14 2v6h6' fill-opacity='.4'/>\
</svg>");
}

/* 라벨(텍스트) 앞 공간 확보 */
.explorer .label,
.explorer .item .text,
.explorer .file .text {
  position: relative;
  padding-left: 22px;
}

/* 폴더 기본 아이콘(닫힘) */
.explorer .folder > .label::before,
.explorer .item.folder > .text::before,
.explorer .node.folder > .text::before {
  content: "";
  position: absolute;
  left: 0; top: 1px;
  width: 16px; height: 16px;
  background-image: svg-url(var(--exp-folder));
  background-size: 16px 16px;
  background-repeat: no-repeat;
}

/* 폴더 열림 */
.explorer .folder.is-open > .label::before,
.explorer .item.folder.is-open > .text::before,
.explorer .node.folder.is-open > .text::before {
  background-image: svg-folder-open(var(--exp-folder));
}

/* 파일 아이콘 */
.explorer .file > .label::before,
.explorer .item.file > .text::before {
  content: "";
  position: absolute;
  left: 0; top: 1px;
  width: 16px; height: 16px;
  background-image: svg-file(var(--exp-file));
  background-size: 16px 16px;
  background-repeat: no-repeat;
}

/* 비활성/회색 처리 (예: disabled/외부링크 등) */
.explorer .muted,
.explorer .dim {
  color: var(--exp-dim);
}

/* 링크 스타일 중립화(파일명 느낌) */
.explorer a {
  color: inherit;
  text-decoration: none;
}
.explorer a:hover {
  text-decoration: underline;
}

/* 밀도 옵션(선택) — 아이템이 조금 더 촘촘하게 보이고 싶다면 해제 */
.explorer.compact .item,
.explorer.compact .node,
.explorer.compact .file {
  padding-top: 4px;
  padding-bottom: 4px;
}


//룰추가
/* 펼침 상태가 aria-expanded 로 표시되는 경우 */
.explorer .item[aria-expanded="true"]::before,
.explorer .node[aria-expanded="true"]::before {
  content: "▾";
}
.explorer .item[aria-expanded="true"] > .label::before {
  background-image: svg-folder-open(var(--exp-folder));
}
